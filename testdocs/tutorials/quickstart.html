

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quickstart &mdash; BISIP 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Polynomial Decomposition" href="decomposition.html" />
    <link rel="prev" title="Data format" href="../user/data_format.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BISIP
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/models.html">The Inversion Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/data_format.html">Data format</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Running-your-first-inversion">Running your first inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Visualizing-the-parameter-traces">Visualizing the parameter traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plotting-models-over-data">Plotting models over data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Printing-best-parameters">Printing best parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Inspecting-the-posterior">Inspecting the posterior</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Saving-results-to-CSV-file">Saving results to CSV file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="decomposition.html">Polynomial Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="pelton.html">The Pelton Cole-Cole model</a></li>
<li class="toctree-l1"><a class="reference internal" href="dias.html">The Dias (2000) model</a></li>
<li class="toctree-l1"><a class="reference internal" href="shin.html">The Shin (2015) model</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BISIP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Quickstart</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/quickstart.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 0;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Quickstart">
<h1>Quickstart<a class="headerlink" href="#Quickstart" title="Permalink to this headline">¶</a></h1>
<p>In this first tutorial we load a data file, perform single-mode Pelton Cole-Cole inversion on it,
visualize the fit quality and posterior distribution and save results to a csv
file. A more in-depth look at the Pelton Cole-Cole model and its parameters is available in
the <a class="reference internal" href="pelton.html"><span class="doc">Pelton</span></a> tutorial.</p>
<div class="section" id="Running-your-first-inversion">
<h2>Running your first inversion<a class="headerlink" href="#Running-your-first-inversion" title="Permalink to this headline">¶</a></h2>
<p>To invert a SIP data file, you would use the following approach:</p>
<ul class="simple">
<li><p>Import the base <code class="code docutils literal notranslate"><span class="pre">PeltonColeCole</span></code> model.</p></li>
<li><p>Pass <code class="code docutils literal notranslate"><span class="pre">filepath</span></code> to instantiate the model with a specific data file.</p></li>
<li><p>Set the simulation to run for 2000 steps by passing <code class="code docutils literal notranslate"><span class="pre">nsteps=2000</span></code>.</p></li>
<li><p>Set the simulation to explore the Dias model parameter space
with <code class="code docutils literal notranslate"><span class="pre">nwalkers=32</span></code>.</p></li>
<li><p>Skip the first 9 lines in the data file with <code class="code docutils literal notranslate"><span class="pre">headers=9</span></code>.</p></li>
<li><p>Fit the model to the data by calling the <code class="code docutils literal notranslate"><span class="pre">fit()</span></code> method.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">bisip</span> <span class="kn">import</span> <span class="n">PeltonColeCole</span>
<span class="kn">from</span> <span class="nn">bisip</span> <span class="kn">import</span> <span class="n">DataFiles</span>

<span class="c1"># This will get one of the example data files in the BISIP package</span>
<span class="n">data_files</span> <span class="o">=</span> <span class="n">DataFiles</span><span class="p">()</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="n">data_files</span><span class="p">[</span><span class="s1">&#39;SIP-K389172&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">PeltonColeCole</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="n">filepath</span><span class="p">,</span>
                       <span class="n">nwalkers</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>  <span class="c1"># number of MCMC walkers</span>
                       <span class="n">nsteps</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>  <span class="c1"># number of MCMC steps</span>
                       <span class="n">headers</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>  <span class="c1"># number of lines to skip in the data file</span>
                       <span class="p">)</span>

<span class="c1"># Fit the model to this data file</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 2000/2000 [00:03&lt;00:00, 647.52it/s]
</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this example we use <cite>headers=9</cite> to skip the header line and the 8 highest measurement frequencies. As a result
we keep only a single polarization mode in the lower frequency range.</p>
</div>
</div>
<div class="section" id="Visualizing-the-parameter-traces">
<h2>Visualizing the parameter traces<a class="headerlink" href="#Visualizing-the-parameter-traces" title="Permalink to this headline">¶</a></h2>
<p>Visual inspection of the traces of each MCMC walker is a good way to quickly assess how well the inversion went. They also define what we consider samples of the posterior distribution. The walkers are initialized at random positions in the parameter space, let’s inspect the parameter traces to see if they have moved towards a unique solution to the inverse problem. Plotting the traces is one of the first things the user should do after completing the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method. Simply call the
<code class="docutils literal notranslate"><span class="pre">plot_traces()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">Inversion</span></code> object to visualize the parameter chains.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the parameter traces</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot_traces</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/tutorials_quickstart_9_0.png"><img alt="../_images/tutorials_quickstart_9_0.png" src="../_images/tutorials_quickstart_9_0.png" style="width: 571px; height: 420px;" /></a>
</div>
</div>
<p>The walkers have correctly moved to similar solutions. As you can see for the first few iterations the walkers are spread out across the entire parameter space. The ensemble has then reached a stationary state after at least 50 steps. To be safe, let’s discard all the values before the 100th step and use the following steps to estimate the best values for our parameters.</p>
<p>You can also store the chain as a numpy ndarray using the <code class="docutils literal notranslate"><span class="pre">get_chain()</span></code> method. Passing the argument <code class="docutils literal notranslate"><span class="pre">flat=True</span></code> will flatten the walkers into a single chain, whereas passing <code class="docutils literal notranslate"><span class="pre">flat=False</span></code> will preserve the <code class="docutils literal notranslate"><span class="pre">nwalkers</span></code> dimension. The <code class="docutils literal notranslate"><span class="pre">thin</span></code> argument will pick one sample every <code class="docutils literal notranslate"><span class="pre">thin</span></code> steps, this can be used to reduce autocorrelation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get chains of all walkers, discarding first 100 steps</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">discard</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (nsteps, nwalkers, ndim)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1900, 32, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get chains of all walkers, discarding first 100 steps,</span>
<span class="c1"># thinning by a factor of 2 and flattening the walkers</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">discard</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">thin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (nsteps*nwalkers/thin, ndim)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(30400, 4)
</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here <code class="code docutils literal notranslate"><span class="pre">ndim</span></code> refers to the number of dimensions of the model (the number of parameters).</p>
</div>
</div>
<div class="section" id="Plotting-models-over-data">
<h2>Plotting models over data<a class="headerlink" href="#Plotting-models-over-data" title="Permalink to this headline">¶</a></h2>
<p>Let’s now plot the best model obtained with this chain using the <code class="docutils literal notranslate"><span class="pre">plot_fit()</span></code> method, which will show the real and imaginary parts of the complex resistivity as a function of measurement frequency. The plot will also display the median model as a red line and the 95% highest probability density interval as dotted lines.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Use the chain argument to plot the model</span>
<span class="c1"># for a specific flattened chain</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>

<span class="c1"># You can then use the `fig` matplotlib object to save the figure or make</span>
<span class="c1"># adjustments according to your personal preference. For example:</span>
<span class="c1"># fig.savefig(&#39;fit_figure_sample_K389172.png&#39;, dpi=144, bbox_inches=&#39;tight&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/tutorials_quickstart_17_0.png"><img alt="../_images/tutorials_quickstart_17_0.png" src="../_images/tutorials_quickstart_17_0.png" style="width: 565px; height: 203px;" /></a>
</div>
</div>
<p>You may also directly pass the arguments of the <code class="docutils literal notranslate"><span class="pre">get_chain()</span></code> method to most plotting functions. By default this will flatten the walkers into a single chain. For example here we use the <code class="docutils literal notranslate"><span class="pre">plot_fit_pa()</span></code> method, which will display the amplitude and phase shift as a function of measurement frequency. We also adjust the confidence interval to display the 72% HPD with the <code class="docutils literal notranslate"><span class="pre">p</span></code> argument (p for percentile).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Use the discard argument to discard samples</span>
<span class="c1"># note that we do not need to pass the chain argument</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot_fit_pa</span><span class="p">(</span><span class="n">discard</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">86</span><span class="p">])</span>  <span class="c1"># 14=lower, 50=median, 86=higher</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/tutorials_quickstart_19_0.png"><img alt="../_images/tutorials_quickstart_19_0.png" src="../_images/tutorials_quickstart_19_0.png" style="width: 567px; height: 203px;" /></a>
</div>
</div>
</div>
<div class="section" id="Printing-best-parameters">
<h2>Printing best parameters<a class="headerlink" href="#Printing-best-parameters" title="Permalink to this headline">¶</a></h2>
<p>Here we will use the <code class="docutils literal notranslate"><span class="pre">get_param_mean()</span></code> and <code class="docutils literal notranslate"><span class="pre">get_param_std()</span></code> utility functions to extract the mean and standard deviations of each parameter in our chain. We will also access the name of each parameter with the <code class="docutils literal notranslate"><span class="pre">param_names</span></code> property.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">values</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_param_mean</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="n">chain</span><span class="p">)</span>
<span class="n">uncertainties</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_param_std</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="n">chain</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param_names</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">uncertainties</span><span class="p">):</span>
  <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{n}: {v:.5f} +/- {u:.5f}&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
r0: 1.02348 +/- 0.00482
m1: 0.36369 +/- 0.02721
log_tau1: -2.15124 +/- 0.25917
c1: 0.50472 +/- 0.03389
</pre></div></div>
</div>
<p>Looks good! The relative error on the recovered parameters is quite small considering our large error bars on the data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important to note that for every inversion scheme the amplitude
values (and the <code class="code docutils literal notranslate"><span class="pre">r0</span></code> parameter) have been normalized by the maximum
amplitude. You may access this normalization factor with
<code class="code docutils literal notranslate"><span class="pre">model.data['norm_factor']</span></code>. Therefore the real <span class="math notranslate nohighlight">\(\rho_0\)</span> value
is <code class="code docutils literal notranslate"><span class="pre">r0</span> <span class="pre">*</span> <span class="pre">model.data['norm_factor']</span></code>.</p>
</div>
</div>
<div class="section" id="Inspecting-the-posterior">
<h2>Inspecting the posterior<a class="headerlink" href="#Inspecting-the-posterior" title="Permalink to this headline">¶</a></h2>
<p>Let’s now visualize the posterior distribution of all parameters using a corner plot (from the corner Python package).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot_corner</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="n">chain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/tutorials_quickstart_27_0.png"><img alt="../_images/tutorials_quickstart_27_0.png" src="../_images/tutorials_quickstart_27_0.png" style="width: 665px; height: 665px;" /></a>
</div>
</div>
<p>This is interesting, we note that the <span class="math notranslate nohighlight">\(\log \tau\)</span> values are anticorrelated with the <span class="math notranslate nohighlight">\(m\)</span> values. It seems like the model can obtain similar fits of the data by adjusting these parameters against each other.</p>
</div>
<div class="section" id="Saving-results-to-CSV-file">
<h2>Saving results to CSV file<a class="headerlink" href="#Saving-results-to-CSV-file" title="Permalink to this headline">¶</a></h2>
<p>Finally let’s save the best parameters and some of their statistics as a csv file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get the lower, median and higher percentiles</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_param_percentile</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="n">chain</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
<span class="c1"># Join the list of parameter names into a comma separated string</span>
<span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param_names</span><span class="p">)</span>
<span class="c1"># Save to csv with numpy</span>
<span class="c1"># The first row is the 2.5th percentile, 2nd the 50th (median), 3rd the 97.5th.</span>
<span class="c1"># Parameter names will be listed in the csv file header.</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
r0,m1,log_tau1,c1
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 1.0145686   0.31432249 -2.6842057   0.43700699]
 [ 1.02333312  0.36246919 -2.14056413  0.50492975]
 [ 1.03353171  0.41976735 -1.6760645   0.57111952]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;quickstart_results.csv&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
           <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="decomposition.html" class="btn btn-neutral float-right" title="Polynomial Decomposition" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../user/data_format.html" class="btn btn-neutral float-left" title="Data format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Charles L. Bérubé

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>